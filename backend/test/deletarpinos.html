<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Deletar Pinos</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Arial, sans-serif;
        background: linear-gradient(135deg, #ff6b6b, #be0000);
        margin: 0;
        padding: 0;
        color: #333;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
      }

      h1 {
        color: white;
        text-shadow: 1px 1px 5px rgba(0, 0, 0, 0.3);
        margin: 30px 0 20px;
        text-align: center;
      }

      #lista-pinos {
        width: 100%;
        max-width: 600px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 16px;
        box-shadow: 0 4px 25px rgba(0, 0, 0, 0.25);
        padding: 25px;
        margin-bottom: 40px;
        backdrop-filter: blur(6px);
      }

      .pino {
        background: #fff;
        padding: 20px;
        margin: 15px 0;
        border-radius: 12px;
        border: 1px solid #e0e0e0;
        transition: all 0.2s ease-in-out;
      }

      .pino:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 15px rgba(255, 107, 107, 0.25);
      }

      .pino strong {
        font-size: 1.2rem;
        color: #d33;
      }

      .pino p {
        margin: 6px 0;
        color: #555;
        font-size: 0.95rem;
      }

      .btn-container {
        display: flex;
        justify-content: center;
        margin-top: 15px;
      }

      .btn-deletar {
        background: #ff4d4d;
        color: #fff;
        border: none;
        padding: 10px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        font-size: 0.95rem;
        transition: background 0.3s ease, transform 0.1s ease;
      }

      .btn-deletar:hover {
        background: #7b0000;
        transform: scale(1.05);
      }

      /* Mensagem de feedback */
      .alerta {
        text-align: center;
        padding: 12px;
        margin-bottom: 20px;
        border-radius: 8px;
        font-weight: 500;
        max-width: 600px;
        width: 90%;
        animation: fadeIn 0.3s ease-in-out;
      }

      .alerta.sucesso {
        background: #64ffb4;
        color: #2f7854;
        border: 1px solid #4dc48a;
      }

      .alerta.erro {
        background: #f8d7da;
        color: #7b0000;
        border: 1px solid #f5c6cb;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (max-width: 600px) {
        #lista-pinos {
          padding: 20px;
          border-radius: 12px;
        }
        .pino {
          padding: 15px;
        }
      }
    </style>
  </head>
  <body>
    <h1>Deletar Pinos</h1>

    <div id="mensagem"></div>
    <div id="lista-pinos">Carregando pinos...</div>

    <script>
      const msgDiv = document.getElementById("mensagem");

      // Fun√ß√£o para mostrar mensagens bonitas
      function mostrarMensagem(texto, tipo) {
        msgDiv.innerHTML = `<div class="alerta ${tipo}">${texto}</div>`;
        setTimeout(() => (msgDiv.innerHTML = ""), 4000);
      }

      // Fun√ß√£o para carregar pinos
      async function carregarPinos() {
        try {
          const resposta = await fetch("/api/pinos");
          const pinos = await resposta.json();

          const lista = document.getElementById("lista-pinos");
          lista.innerHTML = "";

          if (pinos.length === 0) {
            lista.innerHTML =
              '<p style="text-align:center;">üö´ Nenhum pino cadastrado.</p>';
            return;
          }

          pinos.forEach((pino) => {
            const div = document.createElement("div");
            div.classList.add("pino");
            div.innerHTML = `
            <strong>${pino.nome}</strong>
            <p>${pino.msg}</p>
            <p><b>Localiza√ß√£o:</b> ${pino.localizacao.coordinates[1]}, ${pino.localizacao.coordinates[0]}</p>
            <div class="btn-container"><button class="btn-deletar" onclick="deletarPino('${pino._id}')">Deletar</button><div>
          `;
            lista.appendChild(div);
          });
        } catch (erro) {
          console.error("Erro ao carregar pinos:", erro);
          document.getElementById("lista-pinos").innerText =
            "Erro ao carregar pinos.";
        }
      }

      // Fun√ß√£o para deletar pino
      async function deletarPino(id) {
        if (!confirm("‚ùó Tem certeza que deseja deletar este pino?")) return;

        try {
          const resposta = await fetch(`/api/pinos/deletar/${id}`, {
            method: "DELETE",
          });

          if (resposta.ok) {
            mostrarMensagem("‚úÖ Pino deletado com sucesso!", "sucesso");
            carregarPinos();
          } else {
            const erro = await resposta.json();
            mostrarMensagem("‚ùå Erro ao deletar: " + erro.error, "erro");
          }
        } catch (erro) {
          console.error("Erro ao deletar pino:", erro);
          mostrarMensagem("‚ùå Erro inesperado ao deletar pino.", "erro");
        }
      }

      carregarPinos();
    </script>
  </body>
</html>
